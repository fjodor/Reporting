---
title: "Ergebnisse berichten mit R"
subtitle: "<br/>Reproduzierbare Workflows dank Markdown"
author: "Wolf Riepl"
institute: "IT-Schulungen.com"
date: "Stand: `r Sys.time()`"
output:
  xaringan::moon_reader:
    includes:
      after_body: libs/_css/insert-footer.html
    lib_dir: libs
    css: ["libs/_css/my_css.css"]
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      slideNumberFormat: "%current%"
      ratio: 16:9
---

class: hide-footer

background-image: url(libs/_Images/IT-Schulungen_title-slide.png)
background-position: center
background-size: contain

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

???
  
IT-Schulungen.com  
Thurn-und-Taxis-Str. 10  
90411 N√ºrnberg  
Tel. 0911 - 650083 - 0  

---

![](libs/_Images/IT-Schulungen_portfolio.png)

---

background-image: url(libs/_Images/IT-Schulungen_zert-partner.png)
background-position: center
background-size: contain

---
class: inverse, agenda

# Agenda

### *1. Motivation: Warum und wof√ºr Markdown?*
### 2. Einf√ºhrung in das Markdown-Format
### 3. Ausgabe-Formate: Word, PDF, Powerpoint, HTML
### 4. Grafiken, Tabellen, Daten darstellen
### 5. Flexibilit√§t mit parametrisierten Berichten
### 6. Pr√§sentationen, Dashboards, weitere Markdown-Formate
### 7. Erg√§nzungen

---

# Motivation: Reproduzierbarkeit

## Projekte in RStudio

.pull-left[

Jenny Bryan:

> Wenn die erste Zeile Ihres R-Skripts lautet

`setwd(‚ÄúC:/Users/jenny/path/that/only/I/have‚Äú)`

> ... dann komme ich in Ihr B√ºro und Z√úNDE IHREN COMPUTER ANüî•.


> Wenn die erste Zeile Ihres R-Skripts lautet

`rm(list = ls())` 

> ... dann komme ich in Ihr B√ºro und Z√úNDE IHREN COMPUTER ANüî•.

]

.pull-right[

```{r jenny-bryan, echo = FALSE, out.width = "173px", out.height = "173px"}
knitr::include_graphics("libs/_Images/Jenny-Bryan.jpg")
```

  Jenny Bryan  
  RStudio, R Foundation, rOpenSci
]


---

# Motivation: Reproduzierbarkeit

## Warum Projekte in RStudio?

### Grundidee: Den *Arbeitsprozess ("Workflow")* vom *Produkt* trennen

.pull-left[
.content-box-gray[
**Workflow:**
* Editor, mit dem man R-Code schreibt
* Arbeitsverzeichnis
* Code, den man zuvor ausgef√ºhrt hat
 ]
]

.pull-right[
.content-box-grey[
**Produkt:**
* Rohdaten
* R-Code, den andere ausf√ºhren m√ºssen, um die gleichen Ergebnisse zu erhalten  
 ü†ädas beinhaltet Aufrufe von *library()*
 ]
]

https://www.tidyverse.org/blog/2017/12/workflow-vs-script/


---

# Motivation: Reproduzierbarkeit

## RStudio: Projekt anlegen

.pull-left[

```{r create-project, echo = FALSE, out.width = "300px", out.height = "306px"}
knitr::include_graphics("libs/_Images/RStudio_create-project.png")
```

]

.pull-right[
Projektspezifische Arbeitsumgebung:

* Skripte
* Daten
* Befehlsgeschichte (*History*)

]


---

# Motivation: Reproduzierbarkeit

## Vorteile von RStudio-Projekten

.pull-left[

* Mit **relativen Dateipfaden** arbeiten  
*Kleine Projekte:* einfach mit Projektordner arbeiten,  
Dateien ohne Pfadangabe ansprechen  
*Gr√∂√üere Projekte* mit Unterordnern: *here*-Paket verwenden

* Projekte kopieren / verschieben  
(anderer Ordner / Rechner, Kollege):  
funktioniert sofort, ohne Anpassung von Pfaden

* Suche in allen Projekt-Dateien: **Strg + Shift + F  
"Find in Files"**
]

.pull-right[

```{r find-in-files, echo = FALSE}
knitr::include_graphics("libs/_Images/RStudio_find-in-files.png")
```

]

---

# Motivation: Reproduzierbarkeit

## Warum? Es gibt ein Problem ...

```{r Studies-fail-to-replicate, echo = FALSE, out.width = "55%", out.height = "55%", fig.align = "center"}
knitr::include_graphics("libs/_Images/Studies-fail-to-replicate_ocean.png")
```

---

# Motivation: Reproduzierbarkeit

## Warum? Reproduzierbarkeit von Studien, Datenanalysen

**Sch√§tzungen:**

* 75% - 90% pr√§-klinischer Studienergebnisse nicht reproduzierbar
* Kosten f√ºr bio-medizinische Firmen in den USA pro Jahr: 28 Mrd. USD

* Quelle:  
Vortrag von Garrett Grolemund, EARL 2018, 12.9.2018, London  
Video: https://www.youtube.com/watch?v=HVlwNayog-k  
Folien: https://earlconf.com/_downloads/london_speakers/EARL2018_-_London_-_Garrett_Grolemund.pdf

* **Reproduzierbare Ergebnisse dank RMarkdown!**

---

# Motivation: Reproduzierbarkeit

## Ausblick: Versionsverwaltung mit git / github

Erfordert git-Installation; https://git-scm.com/downloads;  
Anleitung siehe https://support.rstudio.com/hc/en-us/articles/200532077-Version-Control-with-Git-and-SVN

```{r git, echo = FALSE, out.width = "50%", out.height = "50%", fig.align = "center"}
knitr::include_graphics("libs/_Images/git.png")
```

---
class: inverse, agenda

# Agenda

### 1. Motivation: Warum und wof√ºr Markdown?
### *2. Einf√ºhrung in das Markdown-Format*
### 3. Ausgabe-Formate: Word, PDF, Powerpoint, HTML
### 4. Grafiken, Tabellen, Daten darstellen
### 5. Flexibilit√§t mit parametrisierten Berichten
### 6. Pr√§sentationen, Dashboards, weitere Markdown-Formate
### 7. Erg√§nzungen

---

# *Pr√§sentation Sparkasse Wien*

*Folien zur Datenbasis: tsort.info, gapminder*

---
layout: true

# Das Markdown-Format

---

## Automatisierte Berichte in Word, PDF, HTML, Powerpoint

.pull-left[

* Markdown: einfache Auszeichnungssprache (‚ÄûMarkup‚Äú-Sprache)  
(Weitere Markup-Sprachen: HTML, XML)  
* R-Paket **rmarkdown** seit 2014
* Word-Dokumente erfordern MS Word-Installation
* PDF-Dokumente erfordern LaTeX-Installation; Empfehlung: **TinyTex** (Alternative: MiKTeX)

* Empfehlung: HTML f√ºr interaktive Elemente!
* Es gibt verschiedene HTML-Formate, inklusive mehreren Pr√§sentations-Varianten

]

.pull-right[
```{r markdown-logo, echo = FALSE, out.width = "60%", out.height = "50%", fig.align = "right"}
knitr::include_graphics("libs/_Images/markdown-logo.png")
```
]

---

## Vorlagen unter File - New File - R Markdown

.pull-left[

```{r markdown-vorlage, echo = FALSE, out.width = "85%", out.height = "85%"}
knitr::include_graphics("libs/_Images/Markdown-Vorlage.png")
```

]

.pull-right[

Jederzeit zwischen HTML, PDF, Word wechseln: im YAML-Header

* output: html_document
* output: word_document
* output: pdf_document

Oder:

```{r knit-to, echo = FALSE, out.width = "40%", out.height = "40%"}
knitr::include_graphics("libs/_Images/knit-to.png")
```

]

---

## YAML Header

* Enth√§lt Meta-Informationen, z. B. Titel, Autor, Datum, Ausgabeformat
* YAML Ain‚Äòt Markup Language <- Yet Another Markup Language
* Gekennzeichnet mit jeweils drei	---	am Anfang des Dokuments
* Grundger√ºst kann aus RStudio-Vorlage √ºbernommen und angepasst werden

**Knit:** Dokument aus .Rmd-Vorlage erstellen

```{r yaml, echo = FALSE, out.width = "70%", out.height = "70%"}
knitr::include_graphics("libs/_Images/yaml-header.png")
```

---

## R-Code und Text mischen

```{r R-Text-Code, echo = FALSE, out.width = "100%", out.height = "100%"}
knitr::include_graphics("libs/_Images/Text_R-Code.png")
knitr::include_graphics("libs/_Images/Text_R-Code_Output.png")
```

---

## R-Code und Text mischen

.pull-left[

Markdown-Code | Ergebnis
--------------|---------
*'r R-code'*  |	R-Code in laufenden Text einbetten,<br>z. B. ‚ÄûDie Daten beruhen auf 'r nrow(albums)' Alben.‚Äú
#<br>##| √úberschrift 1 <br> √úberschrift 2 ‚Ä¶ usw.
\*Text*<br>\_Text_          | *Kursivschrift*
\*\*Text**<br>\_\_Text__    | **Fettschrift**

]

.pull-right[
Markdown-Code | Ergebnis
--------------|---------
\* Punkt 1<br>\* Punkt 2<br> <center> + P 2.1 | Nicht nummerierte Liste
1. Punkt 1<br>2. Punkt 2 | Nummerierte Liste

Weitere Formatierungen siehe:
* https://rmarkdown.rstudio.com/authoring_basics.html
* Markdown Quick Reference in der RStudio-Hilfe

]
   
---

## R Codeblock

```{r Codeblock, echo = FALSE, eval = FALSE}

library(tidyverse)
ggplot(diamonds, aes(x = carat, y = price, color = color)) +
  geom_point() + 
  theme_dark()

```

![R-Codeblock](libs/_Images/R-Codeblock.png)

* Beginnt mit ```` ```{r} ````
* endet mit ```` ``` ```` 
* Wird von R Studio automatisch grau hinterlegt
* Empfehlung: benennen; hier: *Codeblock*; jeder Name muss eindeutig sein
* echo = TRUE:	Codeblock im fertigen Dokument anzeigen; Alternative: FALSE
* eval = FALSE: Code nicht evaluieren (d. h. hier erscheint Code, aber kein Diagramm)
* Tastaturk√ºrzel: **Strg + Alt + I** f√ºgt Codeblock ein

---

## Chunk-Optionen

F√ºr weitere Chunk-Optionen neben *echo* und *eval* siehe https://yihui.org/knitr/options/

* Einstellungen f√ºr Grafiken, z. B. fig.width, fig.height
* Caching, d. h. Zwischenspeichern von Codebl√∂cken f√ºr schnellere Ausf√ºhrung
* Umgang mit Fehlern (anzeigen vs. abbrechen) und Warnungen, Messages (anzeigen vs. unterdr√ºcken)
* Animationen

---



---

layout: false
class: hide-footer

background-image: url(libs/_Images/IT-Schulungen_last-slide.png)
background-position: center
background-size: contain

# .white[Viel Erfolg<br> mit R!]
